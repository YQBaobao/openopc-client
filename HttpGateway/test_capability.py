#!/usr/bin/env python3
# -*- coding: UTF-8 -*-
"""
@ Project     : gateway 
@ File        : test_capability.py
@ Author      : yqbao
@ Version     : V1.0.0
@ Description : 测试多点性能，持续循环读取
"""
import atexit
import json
import os
import time

from HttpGateway.http_client import request, headers, close, creat_client, connect

OPC_SERVER = 'Kepware.KEPServerEX.V6'
GROUP_NAME = 'group0'
TAG_LIST_500 = [
    u'channel_1.Test_1.K1',
    u'channel_1.Test_1.K2',
    u'channel_1.Test_1.K3',
    u'channel_1.Test_1.K4',
    u'channel_1.Test_1.K5',
    u'channel_1.Test_1.K6',
    u'channel_1.Test_1.K7',
    u'channel_1.Test_1.K8',
    u'channel_1.Test_1.K9',
    u'channel_1.Test_1.K10',
    u'channel_1.Test_1.K11',
    u'channel_1.Test_1.K12',
    u'channel_1.Test_1.K13',
    u'channel_1.Test_1.K14',
    u'channel_1.Test_1.K15',
    u'channel_1.Test_1.K16',
    u'channel_1.Test_1.K17',
    u'channel_1.Test_1.K18',
    u'channel_1.Test_1.K19',
    u'channel_1.Test_1.K20',
    u'channel_1.Test_1.K21',
    u'channel_1.Test_1.K22',
    u'channel_1.Test_1.K23',
    u'channel_1.Test_1.K24',
    u'channel_1.Test_1.K25',
    u'channel_1.Test_1.K26',
    u'channel_1.Test_1.K27',
    u'channel_1.Test_1.K28',
    u'channel_1.Test_1.K29',
    u'channel_1.Test_1.K30',
    u'channel_1.Test_1.K31',
    u'channel_1.Test_1.K32',
    u'channel_1.Test_1.K33',
    u'channel_1.Test_1.K34',
    u'channel_1.Test_1.K35',
    u'channel_1.Test_1.K36',
    u'channel_1.Test_1.K37',
    u'channel_1.Test_1.K38',
    u'channel_1.Test_1.K39',
    u'channel_1.Test_1.K40',
    u'channel_1.Test_1.K41',
    u'channel_1.Test_1.K42',
    u'channel_1.Test_1.K43',
    u'channel_1.Test_1.K44',
    u'channel_1.Test_1.K45',
    u'channel_1.Test_1.K46',
    u'channel_1.Test_1.K47',
    u'channel_1.Test_1.K48',
    u'channel_1.Test_1.K49',
    u'channel_1.Test_1.K50',
    u'channel_1.Test_2.K1',
    u'channel_1.Test_2.K2',
    u'channel_1.Test_2.K3',
    u'channel_1.Test_2.K4',
    u'channel_1.Test_2.K5',
    u'channel_1.Test_2.K6',
    u'channel_1.Test_2.K7',
    u'channel_1.Test_2.K8',
    u'channel_1.Test_2.K9',
    u'channel_1.Test_2.K10',
    u'channel_1.Test_2.K11',
    u'channel_1.Test_2.K12',
    u'channel_1.Test_2.K13',
    u'channel_1.Test_2.K14',
    u'channel_1.Test_2.K15',
    u'channel_1.Test_2.K16',
    u'channel_1.Test_2.K17',
    u'channel_1.Test_2.K18',
    u'channel_1.Test_2.K19',
    u'channel_1.Test_2.K20',
    u'channel_1.Test_2.K21',
    u'channel_1.Test_2.K22',
    u'channel_1.Test_2.K23',
    u'channel_1.Test_2.K24',
    u'channel_1.Test_2.K25',
    u'channel_1.Test_2.K26',
    u'channel_1.Test_2.K27',
    u'channel_1.Test_2.K28',
    u'channel_1.Test_2.K29',
    u'channel_1.Test_2.K30',
    u'channel_1.Test_2.K31',
    u'channel_1.Test_2.K32',
    u'channel_1.Test_2.K33',
    u'channel_1.Test_2.K34',
    u'channel_1.Test_2.K35',
    u'channel_1.Test_2.K36',
    u'channel_1.Test_2.K37',
    u'channel_1.Test_2.K38',
    u'channel_1.Test_2.K39',
    u'channel_1.Test_2.K40',
    u'channel_1.Test_2.K41',
    u'channel_1.Test_2.K42',
    u'channel_1.Test_2.K43',
    u'channel_1.Test_2.K44',
    u'channel_1.Test_2.K45',
    u'channel_1.Test_2.K46',
    u'channel_1.Test_2.K47',
    u'channel_1.Test_2.K48',
    u'channel_1.Test_2.K49',
    u'channel_1.Test_2.K50',
    u'channel_1.Test_3.K1',
    u'channel_1.Test_3.K2',
    u'channel_1.Test_3.K3',
    u'channel_1.Test_3.K4',
    u'channel_1.Test_3.K5',
    u'channel_1.Test_3.K6',
    u'channel_1.Test_3.K7',
    u'channel_1.Test_3.K8',
    u'channel_1.Test_3.K9',
    u'channel_1.Test_3.K10',
    u'channel_1.Test_3.K11',
    u'channel_1.Test_3.K12',
    u'channel_1.Test_3.K13',
    u'channel_1.Test_3.K14',
    u'channel_1.Test_3.K15',
    u'channel_1.Test_3.K16',
    u'channel_1.Test_3.K17',
    u'channel_1.Test_3.K18',
    u'channel_1.Test_3.K19',
    u'channel_1.Test_3.K20',
    u'channel_1.Test_3.K21',
    u'channel_1.Test_3.K22',
    u'channel_1.Test_3.K23',
    u'channel_1.Test_3.K24',
    u'channel_1.Test_3.K25',
    u'channel_1.Test_3.K26',
    u'channel_1.Test_3.K27',
    u'channel_1.Test_3.K28',
    u'channel_1.Test_3.K29',
    u'channel_1.Test_3.K30',
    u'channel_1.Test_3.K31',
    u'channel_1.Test_3.K32',
    u'channel_1.Test_3.K33',
    u'channel_1.Test_3.K34',
    u'channel_1.Test_3.K35',
    u'channel_1.Test_3.K36',
    u'channel_1.Test_3.K37',
    u'channel_1.Test_3.K38',
    u'channel_1.Test_3.K39',
    u'channel_1.Test_3.K40',
    u'channel_1.Test_3.K41',
    u'channel_1.Test_3.K42',
    u'channel_1.Test_3.K43',
    u'channel_1.Test_3.K44',
    u'channel_1.Test_3.K45',
    u'channel_1.Test_3.K46',
    u'channel_1.Test_3.K47',
    u'channel_1.Test_3.K48',
    u'channel_1.Test_3.K49',
    u'channel_1.Test_3.K50',
    u'channel_1.Test_4.K1',
    u'channel_1.Test_4.K2',
    u'channel_1.Test_4.K3',
    u'channel_1.Test_4.K4',
    u'channel_1.Test_4.K5',
    u'channel_1.Test_4.K6',
    u'channel_1.Test_4.K7',
    u'channel_1.Test_4.K8',
    u'channel_1.Test_4.K9',
    u'channel_1.Test_4.K10',
    u'channel_1.Test_4.K11',
    u'channel_1.Test_4.K12',
    u'channel_1.Test_4.K13',
    u'channel_1.Test_4.K14',
    u'channel_1.Test_4.K15',
    u'channel_1.Test_4.K16',
    u'channel_1.Test_4.K17',
    u'channel_1.Test_4.K18',
    u'channel_1.Test_4.K19',
    u'channel_1.Test_4.K20',
    u'channel_1.Test_4.K21',
    u'channel_1.Test_4.K22',
    u'channel_1.Test_4.K23',
    u'channel_1.Test_4.K24',
    u'channel_1.Test_4.K25',
    u'channel_1.Test_4.K26',
    u'channel_1.Test_4.K27',
    u'channel_1.Test_4.K28',
    u'channel_1.Test_4.K29',
    u'channel_1.Test_4.K30',
    u'channel_1.Test_4.K31',
    u'channel_1.Test_4.K32',
    u'channel_1.Test_4.K33',
    u'channel_1.Test_4.K34',
    u'channel_1.Test_4.K35',
    u'channel_1.Test_4.K36',
    u'channel_1.Test_4.K37',
    u'channel_1.Test_4.K38',
    u'channel_1.Test_4.K39',
    u'channel_1.Test_4.K40',
    u'channel_1.Test_4.K41',
    u'channel_1.Test_4.K42',
    u'channel_1.Test_4.K43',
    u'channel_1.Test_4.K44',
    u'channel_1.Test_4.K45',
    u'channel_1.Test_4.K46',
    u'channel_1.Test_4.K47',
    u'channel_1.Test_4.K48',
    u'channel_1.Test_4.K49',
    u'channel_1.Test_4.K50',
    u'channel_1.Test_5.K1',
    u'channel_1.Test_5.K2',
    u'channel_1.Test_5.K3',
    u'channel_1.Test_5.K4',
    u'channel_1.Test_5.K5',
    u'channel_1.Test_5.K6',
    u'channel_1.Test_5.K7',
    u'channel_1.Test_5.K8',
    u'channel_1.Test_5.K9',
    u'channel_1.Test_5.K10',
    u'channel_1.Test_5.K11',
    u'channel_1.Test_5.K12',
    u'channel_1.Test_5.K13',
    u'channel_1.Test_5.K14',
    u'channel_1.Test_5.K15',
    u'channel_1.Test_5.K16',
    u'channel_1.Test_5.K17',
    u'channel_1.Test_5.K18',
    u'channel_1.Test_5.K19',
    u'channel_1.Test_5.K20',
    u'channel_1.Test_5.K21',
    u'channel_1.Test_5.K22',
    u'channel_1.Test_5.K23',
    u'channel_1.Test_5.K24',
    u'channel_1.Test_5.K25',
    u'channel_1.Test_5.K26',
    u'channel_1.Test_5.K27',
    u'channel_1.Test_5.K28',
    u'channel_1.Test_5.K29',
    u'channel_1.Test_5.K30',
    u'channel_1.Test_5.K31',
    u'channel_1.Test_5.K32',
    u'channel_1.Test_5.K33',
    u'channel_1.Test_5.K34',
    u'channel_1.Test_5.K35',
    u'channel_1.Test_5.K36',
    u'channel_1.Test_5.K37',
    u'channel_1.Test_5.K38',
    u'channel_1.Test_5.K39',
    u'channel_1.Test_5.K40',
    u'channel_1.Test_5.K41',
    u'channel_1.Test_5.K42',
    u'channel_1.Test_5.K43',
    u'channel_1.Test_5.K44',
    u'channel_1.Test_5.K45',
    u'channel_1.Test_5.K46',
    u'channel_1.Test_5.K47',
    u'channel_1.Test_5.K48',
    u'channel_1.Test_5.K49',
    u'channel_1.Test_5.K50',
    u'channel_1.Test_6.K1',
    u'channel_1.Test_6.K2',
    u'channel_1.Test_6.K3',
    u'channel_1.Test_6.K4',
    u'channel_1.Test_6.K5',
    u'channel_1.Test_6.K6',
    u'channel_1.Test_6.K7',
    u'channel_1.Test_6.K8',
    u'channel_1.Test_6.K9',
    u'channel_1.Test_6.K10',
    u'channel_1.Test_6.K11',
    u'channel_1.Test_6.K12',
    u'channel_1.Test_6.K13',
    u'channel_1.Test_6.K14',
    u'channel_1.Test_6.K15',
    u'channel_1.Test_6.K16',
    u'channel_1.Test_6.K17',
    u'channel_1.Test_6.K18',
    u'channel_1.Test_6.K19',
    u'channel_1.Test_6.K20',
    u'channel_1.Test_6.K21',
    u'channel_1.Test_6.K22',
    u'channel_1.Test_6.K23',
    u'channel_1.Test_6.K24',
    u'channel_1.Test_6.K25',
    u'channel_1.Test_6.K26',
    u'channel_1.Test_6.K27',
    u'channel_1.Test_6.K28',
    u'channel_1.Test_6.K29',
    u'channel_1.Test_6.K30',
    u'channel_1.Test_6.K31',
    u'channel_1.Test_6.K32',
    u'channel_1.Test_6.K33',
    u'channel_1.Test_6.K34',
    u'channel_1.Test_6.K35',
    u'channel_1.Test_6.K36',
    u'channel_1.Test_6.K37',
    u'channel_1.Test_6.K38',
    u'channel_1.Test_6.K39',
    u'channel_1.Test_6.K40',
    u'channel_1.Test_6.K41',
    u'channel_1.Test_6.K42',
    u'channel_1.Test_6.K43',
    u'channel_1.Test_6.K44',
    u'channel_1.Test_6.K45',
    u'channel_1.Test_6.K46',
    u'channel_1.Test_6.K47',
    u'channel_1.Test_6.K48',
    u'channel_1.Test_6.K49',
    u'channel_1.Test_6.K50',
    u'channel_1.Test_7.K1',
    u'channel_1.Test_7.K2',
    u'channel_1.Test_7.K3',
    u'channel_1.Test_7.K4',
    u'channel_1.Test_7.K5',
    u'channel_1.Test_7.K6',
    u'channel_1.Test_7.K7',
    u'channel_1.Test_7.K8',
    u'channel_1.Test_7.K9',
    u'channel_1.Test_7.K10',
    u'channel_1.Test_7.K11',
    u'channel_1.Test_7.K12',
    u'channel_1.Test_7.K13',
    u'channel_1.Test_7.K14',
    u'channel_1.Test_7.K15',
    u'channel_1.Test_7.K16',
    u'channel_1.Test_7.K17',
    u'channel_1.Test_7.K18',
    u'channel_1.Test_7.K19',
    u'channel_1.Test_7.K20',
    u'channel_1.Test_7.K21',
    u'channel_1.Test_7.K22',
    u'channel_1.Test_7.K23',
    u'channel_1.Test_7.K24',
    u'channel_1.Test_7.K25',
    u'channel_1.Test_7.K26',
    u'channel_1.Test_7.K27',
    u'channel_1.Test_7.K28',
    u'channel_1.Test_7.K29',
    u'channel_1.Test_7.K30',
    u'channel_1.Test_7.K31',
    u'channel_1.Test_7.K32',
    u'channel_1.Test_7.K33',
    u'channel_1.Test_7.K34',
    u'channel_1.Test_7.K35',
    u'channel_1.Test_7.K36',
    u'channel_1.Test_7.K37',
    u'channel_1.Test_7.K38',
    u'channel_1.Test_7.K39',
    u'channel_1.Test_7.K40',
    u'channel_1.Test_7.K41',
    u'channel_1.Test_7.K42',
    u'channel_1.Test_7.K43',
    u'channel_1.Test_7.K44',
    u'channel_1.Test_7.K45',
    u'channel_1.Test_7.K46',
    u'channel_1.Test_7.K47',
    u'channel_1.Test_7.K48',
    u'channel_1.Test_7.K49',
    u'channel_1.Test_7.K50',
    u'channel_1.Test_8.K1',
    u'channel_1.Test_8.K2',
    u'channel_1.Test_8.K3',
    u'channel_1.Test_8.K4',
    u'channel_1.Test_8.K5',
    u'channel_1.Test_8.K6',
    u'channel_1.Test_8.K7',
    u'channel_1.Test_8.K8',
    u'channel_1.Test_8.K9',
    u'channel_1.Test_8.K10',
    u'channel_1.Test_8.K11',
    u'channel_1.Test_8.K12',
    u'channel_1.Test_8.K13',
    u'channel_1.Test_8.K14',
    u'channel_1.Test_8.K15',
    u'channel_1.Test_8.K16',
    u'channel_1.Test_8.K17',
    u'channel_1.Test_8.K18',
    u'channel_1.Test_8.K19',
    u'channel_1.Test_8.K20',
    u'channel_1.Test_8.K21',
    u'channel_1.Test_8.K22',
    u'channel_1.Test_8.K23',
    u'channel_1.Test_8.K24',
    u'channel_1.Test_8.K25',
    u'channel_1.Test_8.K26',
    u'channel_1.Test_8.K27',
    u'channel_1.Test_8.K28',
    u'channel_1.Test_8.K29',
    u'channel_1.Test_8.K30',
    u'channel_1.Test_8.K31',
    u'channel_1.Test_8.K32',
    u'channel_1.Test_8.K33',
    u'channel_1.Test_8.K34',
    u'channel_1.Test_8.K35',
    u'channel_1.Test_8.K36',
    u'channel_1.Test_8.K37',
    u'channel_1.Test_8.K38',
    u'channel_1.Test_8.K39',
    u'channel_1.Test_8.K40',
    u'channel_1.Test_8.K41',
    u'channel_1.Test_8.K42',
    u'channel_1.Test_8.K43',
    u'channel_1.Test_8.K44',
    u'channel_1.Test_8.K45',
    u'channel_1.Test_8.K46',
    u'channel_1.Test_8.K47',
    u'channel_1.Test_8.K48',
    u'channel_1.Test_8.K49',
    u'channel_1.Test_8.K50',
    u'channel_1.Test_9.K1',
    u'channel_1.Test_9.K2',
    u'channel_1.Test_9.K3',
    u'channel_1.Test_9.K4',
    u'channel_1.Test_9.K5',
    u'channel_1.Test_9.K6',
    u'channel_1.Test_9.K7',
    u'channel_1.Test_9.K8',
    u'channel_1.Test_9.K9',
    u'channel_1.Test_9.K10',
    u'channel_1.Test_9.K11',
    u'channel_1.Test_9.K12',
    u'channel_1.Test_9.K13',
    u'channel_1.Test_9.K14',
    u'channel_1.Test_9.K15',
    u'channel_1.Test_9.K16',
    u'channel_1.Test_9.K17',
    u'channel_1.Test_9.K18',
    u'channel_1.Test_9.K19',
    u'channel_1.Test_9.K20',
    u'channel_1.Test_9.K21',
    u'channel_1.Test_9.K22',
    u'channel_1.Test_9.K23',
    u'channel_1.Test_9.K24',
    u'channel_1.Test_9.K25',
    u'channel_1.Test_9.K26',
    u'channel_1.Test_9.K27',
    u'channel_1.Test_9.K28',
    u'channel_1.Test_9.K29',
    u'channel_1.Test_9.K30',
    u'channel_1.Test_9.K31',
    u'channel_1.Test_9.K32',
    u'channel_1.Test_9.K33',
    u'channel_1.Test_9.K34',
    u'channel_1.Test_9.K35',
    u'channel_1.Test_9.K36',
    u'channel_1.Test_9.K37',
    u'channel_1.Test_9.K38',
    u'channel_1.Test_9.K39',
    u'channel_1.Test_9.K40',
    u'channel_1.Test_9.K41',
    u'channel_1.Test_9.K42',
    u'channel_1.Test_9.K43',
    u'channel_1.Test_9.K44',
    u'channel_1.Test_9.K45',
    u'channel_1.Test_9.K46',
    u'channel_1.Test_9.K47',
    u'channel_1.Test_9.K48',
    u'channel_1.Test_9.K49',
    u'channel_1.Test_9.K50',
    u'channel_1.Test_10.K1',
    u'channel_1.Test_10.K2',
    u'channel_1.Test_10.K3',
    u'channel_1.Test_10.K4',
    u'channel_1.Test_10.K5',
    u'channel_1.Test_10.K6',
    u'channel_1.Test_10.K7',
    u'channel_1.Test_10.K8',
    u'channel_1.Test_10.K9',
    u'channel_1.Test_10.K10',
    u'channel_1.Test_10.K11',
    u'channel_1.Test_10.K12',
    u'channel_1.Test_10.K13',
    u'channel_1.Test_10.K14',
    u'channel_1.Test_10.K15',
    u'channel_1.Test_10.K16',
    u'channel_1.Test_10.K17',
    u'channel_1.Test_10.K18',
    u'channel_1.Test_10.K19',
    u'channel_1.Test_10.K20',
    u'channel_1.Test_10.K21',
    u'channel_1.Test_10.K22',
    u'channel_1.Test_10.K23',
    u'channel_1.Test_10.K24',
    u'channel_1.Test_10.K25',
    u'channel_1.Test_10.K26',
    u'channel_1.Test_10.K27',
    u'channel_1.Test_10.K28',
    u'channel_1.Test_10.K29',
    u'channel_1.Test_10.K30',
    u'channel_1.Test_10.K31',
    u'channel_1.Test_10.K32',
    u'channel_1.Test_10.K33',
    u'channel_1.Test_10.K34',
    u'channel_1.Test_10.K35',
    u'channel_1.Test_10.K36',
    u'channel_1.Test_10.K37',
    u'channel_1.Test_10.K38',
    u'channel_1.Test_10.K39',
    u'channel_1.Test_10.K40',
    u'channel_1.Test_10.K41',
    u'channel_1.Test_10.K42',
    u'channel_1.Test_10.K43',
    u'channel_1.Test_10.K44',
    u'channel_1.Test_10.K45',
    u'channel_1.Test_10.K46',
    u'channel_1.Test_10.K47',
    u'channel_1.Test_10.K48',
    u'channel_1.Test_10.K49',
    u'channel_1.Test_10.K50',
]
TAG_LIST_250 = [
    u'channel_1.Test_1.K1',
    u'channel_1.Test_1.K2',
    u'channel_1.Test_1.K3',
    u'channel_1.Test_1.K4',
    u'channel_1.Test_1.K5',
    u'channel_1.Test_1.K6',
    u'channel_1.Test_1.K7',
    u'channel_1.Test_1.K8',
    u'channel_1.Test_1.K9',
    u'channel_1.Test_1.K10',
    u'channel_1.Test_1.K11',
    u'channel_1.Test_1.K12',
    u'channel_1.Test_1.K13',
    u'channel_1.Test_1.K14',
    u'channel_1.Test_1.K15',
    u'channel_1.Test_1.K16',
    u'channel_1.Test_1.K17',
    u'channel_1.Test_1.K18',
    u'channel_1.Test_1.K19',
    u'channel_1.Test_1.K20',
    u'channel_1.Test_1.K21',
    u'channel_1.Test_1.K22',
    u'channel_1.Test_1.K23',
    u'channel_1.Test_1.K24',
    u'channel_1.Test_1.K25',
    u'channel_1.Test_1.K26',
    u'channel_1.Test_1.K27',
    u'channel_1.Test_1.K28',
    u'channel_1.Test_1.K29',
    u'channel_1.Test_1.K30',
    u'channel_1.Test_1.K31',
    u'channel_1.Test_1.K32',
    u'channel_1.Test_1.K33',
    u'channel_1.Test_1.K34',
    u'channel_1.Test_1.K35',
    u'channel_1.Test_1.K36',
    u'channel_1.Test_1.K37',
    u'channel_1.Test_1.K38',
    u'channel_1.Test_1.K39',
    u'channel_1.Test_1.K40',
    u'channel_1.Test_1.K41',
    u'channel_1.Test_1.K42',
    u'channel_1.Test_1.K43',
    u'channel_1.Test_1.K44',
    u'channel_1.Test_1.K45',
    u'channel_1.Test_1.K46',
    u'channel_1.Test_1.K47',
    u'channel_1.Test_1.K48',
    u'channel_1.Test_1.K49',
    u'channel_1.Test_1.K50',
    u'channel_1.Test_2.K1',
    u'channel_1.Test_2.K2',
    u'channel_1.Test_2.K3',
    u'channel_1.Test_2.K4',
    u'channel_1.Test_2.K5',
    u'channel_1.Test_2.K6',
    u'channel_1.Test_2.K7',
    u'channel_1.Test_2.K8',
    u'channel_1.Test_2.K9',
    u'channel_1.Test_2.K10',
    u'channel_1.Test_2.K11',
    u'channel_1.Test_2.K12',
    u'channel_1.Test_2.K13',
    u'channel_1.Test_2.K14',
    u'channel_1.Test_2.K15',
    u'channel_1.Test_2.K16',
    u'channel_1.Test_2.K17',
    u'channel_1.Test_2.K18',
    u'channel_1.Test_2.K19',
    u'channel_1.Test_2.K20',
    u'channel_1.Test_2.K21',
    u'channel_1.Test_2.K22',
    u'channel_1.Test_2.K23',
    u'channel_1.Test_2.K24',
    u'channel_1.Test_2.K25',
    u'channel_1.Test_2.K26',
    u'channel_1.Test_2.K27',
    u'channel_1.Test_2.K28',
    u'channel_1.Test_2.K29',
    u'channel_1.Test_2.K30',
    u'channel_1.Test_2.K31',
    u'channel_1.Test_2.K32',
    u'channel_1.Test_2.K33',
    u'channel_1.Test_2.K34',
    u'channel_1.Test_2.K35',
    u'channel_1.Test_2.K36',
    u'channel_1.Test_2.K37',
    u'channel_1.Test_2.K38',
    u'channel_1.Test_2.K39',
    u'channel_1.Test_2.K40',
    u'channel_1.Test_2.K41',
    u'channel_1.Test_2.K42',
    u'channel_1.Test_2.K43',
    u'channel_1.Test_2.K44',
    u'channel_1.Test_2.K45',
    u'channel_1.Test_2.K46',
    u'channel_1.Test_2.K47',
    u'channel_1.Test_2.K48',
    u'channel_1.Test_2.K49',
    u'channel_1.Test_2.K50',
    u'channel_1.Test_3.K1',
    u'channel_1.Test_3.K2',
    u'channel_1.Test_3.K3',
    u'channel_1.Test_3.K4',
    u'channel_1.Test_3.K5',
    u'channel_1.Test_3.K6',
    u'channel_1.Test_3.K7',
    u'channel_1.Test_3.K8',
    u'channel_1.Test_3.K9',
    u'channel_1.Test_3.K10',
    u'channel_1.Test_3.K11',
    u'channel_1.Test_3.K12',
    u'channel_1.Test_3.K13',
    u'channel_1.Test_3.K14',
    u'channel_1.Test_3.K15',
    u'channel_1.Test_3.K16',
    u'channel_1.Test_3.K17',
    u'channel_1.Test_3.K18',
    u'channel_1.Test_3.K19',
    u'channel_1.Test_3.K20',
    u'channel_1.Test_3.K21',
    u'channel_1.Test_3.K22',
    u'channel_1.Test_3.K23',
    u'channel_1.Test_3.K24',
    u'channel_1.Test_3.K25',
    u'channel_1.Test_3.K26',
    u'channel_1.Test_3.K27',
    u'channel_1.Test_3.K28',
    u'channel_1.Test_3.K29',
    u'channel_1.Test_3.K30',
    u'channel_1.Test_3.K31',
    u'channel_1.Test_3.K32',
    u'channel_1.Test_3.K33',
    u'channel_1.Test_3.K34',
    u'channel_1.Test_3.K35',
    u'channel_1.Test_3.K36',
    u'channel_1.Test_3.K37',
    u'channel_1.Test_3.K38',
    u'channel_1.Test_3.K39',
    u'channel_1.Test_3.K40',
    u'channel_1.Test_3.K41',
    u'channel_1.Test_3.K42',
    u'channel_1.Test_3.K43',
    u'channel_1.Test_3.K44',
    u'channel_1.Test_3.K45',
    u'channel_1.Test_3.K46',
    u'channel_1.Test_3.K47',
    u'channel_1.Test_3.K48',
    u'channel_1.Test_3.K49',
    u'channel_1.Test_3.K50',
    u'channel_1.Test_4.K1',
    u'channel_1.Test_4.K2',
    u'channel_1.Test_4.K3',
    u'channel_1.Test_4.K4',
    u'channel_1.Test_4.K5',
    u'channel_1.Test_4.K6',
    u'channel_1.Test_4.K7',
    u'channel_1.Test_4.K8',
    u'channel_1.Test_4.K9',
    u'channel_1.Test_4.K10',
    u'channel_1.Test_4.K11',
    u'channel_1.Test_4.K12',
    u'channel_1.Test_4.K13',
    u'channel_1.Test_4.K14',
    u'channel_1.Test_4.K15',
    u'channel_1.Test_4.K16',
    u'channel_1.Test_4.K17',
    u'channel_1.Test_4.K18',
    u'channel_1.Test_4.K19',
    u'channel_1.Test_4.K20',
    u'channel_1.Test_4.K21',
    u'channel_1.Test_4.K22',
    u'channel_1.Test_4.K23',
    u'channel_1.Test_4.K24',
    u'channel_1.Test_4.K25',
    u'channel_1.Test_4.K26',
    u'channel_1.Test_4.K27',
    u'channel_1.Test_4.K28',
    u'channel_1.Test_4.K29',
    u'channel_1.Test_4.K30',
    u'channel_1.Test_4.K31',
    u'channel_1.Test_4.K32',
    u'channel_1.Test_4.K33',
    u'channel_1.Test_4.K34',
    u'channel_1.Test_4.K35',
    u'channel_1.Test_4.K36',
    u'channel_1.Test_4.K37',
    u'channel_1.Test_4.K38',
    u'channel_1.Test_4.K39',
    u'channel_1.Test_4.K40',
    u'channel_1.Test_4.K41',
    u'channel_1.Test_4.K42',
    u'channel_1.Test_4.K43',
    u'channel_1.Test_4.K44',
    u'channel_1.Test_4.K45',
    u'channel_1.Test_4.K46',
    u'channel_1.Test_4.K47',
    u'channel_1.Test_4.K48',
    u'channel_1.Test_4.K49',
    u'channel_1.Test_4.K50',
    u'channel_1.Test_5.K1',
    u'channel_1.Test_5.K2',
    u'channel_1.Test_5.K3',
    u'channel_1.Test_5.K4',
    u'channel_1.Test_5.K5',
    u'channel_1.Test_5.K6',
    u'channel_1.Test_5.K7',
    u'channel_1.Test_5.K8',
    u'channel_1.Test_5.K9',
    u'channel_1.Test_5.K10',
    u'channel_1.Test_5.K11',
    u'channel_1.Test_5.K12',
    u'channel_1.Test_5.K13',
    u'channel_1.Test_5.K14',
    u'channel_1.Test_5.K15',
    u'channel_1.Test_5.K16',
    u'channel_1.Test_5.K17',
    u'channel_1.Test_5.K18',
    u'channel_1.Test_5.K19',
    u'channel_1.Test_5.K20',
    u'channel_1.Test_5.K21',
    u'channel_1.Test_5.K22',
    u'channel_1.Test_5.K23',
    u'channel_1.Test_5.K24',
    u'channel_1.Test_5.K25',
    u'channel_1.Test_5.K26',
    u'channel_1.Test_5.K27',
    u'channel_1.Test_5.K28',
    u'channel_1.Test_5.K29',
    u'channel_1.Test_5.K30',
    u'channel_1.Test_5.K31',
    u'channel_1.Test_5.K32',
    u'channel_1.Test_5.K33',
    u'channel_1.Test_5.K34',
    u'channel_1.Test_5.K35',
    u'channel_1.Test_5.K36',
    u'channel_1.Test_5.K37',
    u'channel_1.Test_5.K38',
    u'channel_1.Test_5.K39',
    u'channel_1.Test_5.K40',
    u'channel_1.Test_5.K41',
    u'channel_1.Test_5.K42',
    u'channel_1.Test_5.K43',
    u'channel_1.Test_5.K44',
    u'channel_1.Test_5.K45',
    u'channel_1.Test_5.K46',
    u'channel_1.Test_5.K47',
    u'channel_1.Test_5.K48',
    u'channel_1.Test_5.K49',
    u'channel_1.Test_5.K50'
]
TAG_LIST_50 = [
    u'channel_1.Test_1.K1',
    u'channel_1.Test_1.K2',
    u'channel_1.Test_1.K3',
    u'channel_1.Test_1.K4',
    u'channel_1.Test_1.K5',
    u'channel_1.Test_1.K6',
    u'channel_1.Test_1.K7',
    u'channel_1.Test_1.K8',
    u'channel_1.Test_1.K9',
    u'channel_1.Test_1.K10',
    u'channel_1.Test_1.K11',
    u'channel_1.Test_1.K12',
    u'channel_1.Test_1.K13',
    u'channel_1.Test_1.K14',
    u'channel_1.Test_1.K15',
    u'channel_1.Test_1.K16',
    u'channel_1.Test_1.K17',
    u'channel_1.Test_1.K18',
    u'channel_1.Test_1.K19',
    u'channel_1.Test_1.K20',
    u'channel_1.Test_1.K21',
    u'channel_1.Test_1.K22',
    u'channel_1.Test_1.K23',
    u'channel_1.Test_1.K24',
    u'channel_1.Test_1.K25',
    u'channel_1.Test_1.K26',
    u'channel_1.Test_1.K27',
    u'channel_1.Test_1.K28',
    u'channel_1.Test_1.K29',
    u'channel_1.Test_1.K30',
    u'channel_1.Test_1.K31',
    u'channel_1.Test_1.K32',
    u'channel_1.Test_1.K33',
    u'channel_1.Test_1.K34',
    u'channel_1.Test_1.K35',
    u'channel_1.Test_1.K36',
    u'channel_1.Test_1.K37',
    u'channel_1.Test_1.K38',
    u'channel_1.Test_1.K39',
    u'channel_1.Test_1.K40',
    u'channel_1.Test_1.K41',
    u'channel_1.Test_1.K42',
    u'channel_1.Test_1.K43',
    u'channel_1.Test_1.K44',
    u'channel_1.Test_1.K45',
    u'channel_1.Test_1.K46',
    u'channel_1.Test_1.K47',
    u'channel_1.Test_1.K48',
    u'channel_1.Test_1.K49',
    u'channel_1.Test_1.K50'
]
TAG_LIST = [
    u'channel_1.Test_1.K1',
    u'channel_1.Test_7.K7',
    u'channel_2.Test_1.Random1'
]
if "PYRO_HTTPGATEWAY_KEY" in os.environ:
    gateway_key = os.environ["PYRO_HTTPGATEWAY_KEY"]
else:
    gateway_key = ''

HOST = "http://192.167.6.192:7767"  # 远程地址
url = "{}/pyro/remote.opcda.client/read".format(HOST)


def read(tag_list):
    data = {"tags": tag_list, "group": GROUP_NAME, "timeout": 5000, "sync": False}
    response = request(method="post", url=url, data=data, header=headers)
    return response


def reads(tag_list):
    data = {"tags": tag_list, "timeout": 5000, "sync": False}
    response = request(method="post", url=url, data=data, header=headers)
    return response


def resolve(num, opc_data):
    try:
        # print(opc_data.text)
        opc_data = str(opc_data.content, encoding="utf-8")
        opc_data = json.loads(opc_data)
        send_values = {}
        for item in list(opc_data):
            name, value, quality, time_ = item
            if quality == 'Good':
                send_values[name] = value
            else:
                print('Error:  {}'.format(item))
            send_values['time'] = time_
        # print(send_values)
        with open('values.txt', 'a+', encoding='utf-8') as f:
            f.write(f'{num}-' + json.dumps(send_values) + '\n')
    except Exception as e:
        print(e.args)


if __name__ == '__main__':
    try:
        close()
    except Exception as e:
        print(e)
    finally:
        atexit.register(close)
        i = 1
        creat_client()
        connect()
        res = read(TAG_LIST_500)  # 划分组只需要一次
        resolve(i, res)
        while True:
            i += 1
            res = reads(TAG_LIST_500)
            resolve(i, res)
            time.sleep(1)
